# K9s Plugin for Mittens (mitmproxy interceptor)
# 
# This plugin allows you to quickly tap services directly from k9s.
# Named "mittens" - a nod to k9s (dog) and mitmproxy, plus "Mitten" (German for "in the middle")
# 
# Installation:
# 1. Copy this content to ~/.k9s/plugins.yaml (create the file if it doesn't exist)
# 2. Restart k9s
# 3. Navigate to Services in k9s
# 4. Press 'ctrl-m' to tap a service with mittens

plugins:
  mittens-tap:
    shortCut: ctrl-m
    description: Mittens - Tap a Service (enable mitmproxy intercepting)
    scopes:
      - services
    command: kubectl
    background: false
    args:
      - mittens
      - on
      - $NAME
      - -n
      - $NAMESPACE
  
  mittens-tap-pod:
    shortCut: ctrl-m
    description: Mittens - Tap the Service for this Pod (enable mitmproxy intercepting)
    scopes:
      - pods
    command: sh
    background: false
    args:
      - -c
      - kubectl mittens on $(kubectl get pod $NAME -n $NAMESPACE -o jsonpath='{.metadata.labels.app}') -n $NAMESPACE
